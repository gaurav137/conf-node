{
    "name": "default-policy",
    "defaultAction": "allow",
    "rules": [
        {
            "name": "deny-privileged-containers",
            "action": "deny",
            "match": {
                "security": {
                    "denyPrivileged": true
                }
            },
            "message": "Privileged containers are not allowed"
        },
        {
            "name": "deny-host-namespaces",
            "action": "deny",
            "match": {
                "security": {
                    "denyHostNetwork": true,
                    "denyHostPID": true,
                    "denyHostIPC": true
                }
            },
            "message": "Host namespaces (network, PID, IPC) are not allowed"
        },
        {
            "name": "deny-host-path-volumes",
            "action": "deny",
            "match": {
                "security": {
                    "denyHostPath": true
                }
            },
            "message": "HostPath volumes are not allowed"
        },
        {
            "name": "deny-dangerous-capabilities",
            "action": "deny",
            "match": {
                "security": {
                    "deniedCapabilities": [
                        "SYS_ADMIN",
                        "NET_ADMIN",
                        "SYS_PTRACE",
                        "SYS_MODULE"
                    ]
                }
            },
            "message": "Dangerous capabilities are not allowed"
        },
        {
            "name": "allow-kube-system",
            "action": "allow",
            "match": {
                "namespaces": [
                    "kube-system"
                ]
            },
            "message": "System namespace is always allowed"
        },
        {
            "name": "require-trusted-registry",
            "action": "deny",
            "match": {
                "namespaces": [
                    "production",
                    "staging"
                ],
                "images": {
                    "allowedRegistries": [
                        "mcr.microsoft.com/",
                        "docker.io/library/",
                        "gcr.io/",
                        "ghcr.io/"
                    ]
                }
            },
            "message": "Only images from trusted registries are allowed in production/staging"
        }
    ]
}