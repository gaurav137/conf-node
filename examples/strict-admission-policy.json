{
    "name": "strict-policy",
    "defaultAction": "deny",
    "rules": [
        {
            "name": "allow-kube-system",
            "action": "allow",
            "match": {
                "namespaces": [
                    "kube-system",
                    "kube-public",
                    "kube-node-lease"
                ]
            },
            "message": "System namespaces are allowed"
        },
        {
            "name": "allow-azure-system",
            "action": "allow",
            "match": {
                "namespaceRegex": "^(azure|gatekeeper|calico|tigera).*"
            },
            "message": "Azure system namespaces are allowed"
        },
        {
            "name": "deny-privileged",
            "action": "deny",
            "match": {
                "security": {
                    "denyPrivileged": true,
                    "denyHostNetwork": true,
                    "denyHostPID": true,
                    "denyHostIPC": true,
                    "denyHostPath": true,
                    "denyRunAsRoot": true,
                    "deniedCapabilities": [
                        "ALL",
                        "SYS_ADMIN",
                        "NET_ADMIN",
                        "SYS_PTRACE",
                        "SYS_MODULE",
                        "SYS_RAWIO",
                        "SYS_BOOT",
                        "MAC_ADMIN",
                        "MAC_OVERRIDE"
                    ]
                }
            },
            "message": "Security policy violation: privileged access is denied"
        },
        {
            "name": "require-image-digest",
            "action": "deny",
            "match": {
                "images": {
                    "requireDigest": true
                }
            },
            "message": "Images must use a digest (@sha256:...) for reproducibility"
        },
        {
            "name": "allow-approved-workloads",
            "action": "allow",
            "match": {
                "labels": {
                    "security.azure.com/approved": "true"
                }
            },
            "message": "Workload is approved via label"
        }
    ]
}